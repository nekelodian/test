<?php
  $host = 'localhost';
  $db_name = 'users';
  $db_id = 'root';
  $db_pw = '111111';
  $db_conn = mysqli_connect($host, $db_id, $db_pw, $db_name);
?>
<?php
  error_reporting( E_ALL );
  ini_set( "display_errors", 1 );
?>

<html>
<head>
  <title>Login Page</title>
  <style>
  h1{
    padding:20px;
    width:500px;
  }
  </style>
</head>
<body style="background-color:lightgray;">
<h1 style="background-color:black; color:white;">Find admin's password</h1>
<div style="border:1px solid; padding:20px; background-color:white; width: 500px">

<p>
Please login with your account.
</p>
<form  action="login_form.php" method="GET">
  <div class="input">
    User ID : <input name="id"><br>
    password : <input name="pw"><br><br>
  </div>
<input type="submit" value="submit" />
</form>

<?php

  if(isset($_GET["id"])&&isset($_GET["pw"])){
    $id = $_GET["id"];
    $pw = $_GET["pw"];

    if(preg_match('/or|\\\|#|-| |=|\'/i', $id))  exit("filtering");
    //if(preg_match('/or|\\\|-|=/i', $pw))  exit("filtering");

    $query = "SELECT pw FROM admin_info WHERE id='{$id}' and pw='{$pw}'";
    $result = mysqli_query($db_conn, $query);
    if(!empty($result)||$result==true){
      $row = mysqli_fetch_array($result);
    }

    if(isset($row['pw'])){
      if($id=="admin"){
        if($pw == $row['pw'])
          $msg = "solved";
        else
          $msg = "hello admin";
      }else{
        $msg = "hello $id";
      }
    }else{
      $msg = "please check your id or password";
    }
    echo $msg;
  }

?>
</html>
